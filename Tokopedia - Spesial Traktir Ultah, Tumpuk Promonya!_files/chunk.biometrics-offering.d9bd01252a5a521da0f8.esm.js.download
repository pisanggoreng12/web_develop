(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[166,455],{1181:function(e,i,n){"use strict";n.r(i);var t=n(0),a=n.n(t),r=n(1201),s=n(9),c=n(108);const o="otpdefault_wpe";var u=function(){const{loadingRollence:e,getVariant:i}=Object(c.a)({version:2,rollenceType:"ROLLOUT",expName:o}),{variant:n}=i(o);return{loadingRollence:e,isHideSMSMethod:n===o}};i.default=e=>{const{isHideSMSMethod:i}=u(),n={...e,isAutoClickEnabled:s.f,autoClickData:s.e,layout:"desktop",isEnableHideSMSMethod:i};return a.a.createElement(r.a,n)}},1201:function(e,i,n){"use strict";var t=n(4),a=Object(t.default)({resolved:{},chunkName:()=>"otp",isReady(e){var i=this.resolve(e);return!1!==this.resolved[i]&&!!n.m[i]},importAsync:function(){return Promise.all([n.e(83),n.e(452)]).then(n.bind(null,1242))},requireAsync(e){var i=this,n=this.resolve(e);return this.resolved[n]=!1,this.importAsync(e).then((function(e){return i.resolved[n]=!0,e}))},requireSync(e){var i=this.resolve(e);return n(i)},resolve(){return 1242}},{ssr:!1});i.a=a},1535:function(e,i,n){"use strict";n.d(i,"e",(function(){return a})),n.d(i,"d",(function(){return r})),n.d(i,"a",(function(){return s})),n.d(i,"c",(function(){return c})),n.d(i,"b",(function(){return o}));var t=n(69),a=function(e){var i=e.isEnable,n=void 0===i||i,a=e.event,r=void 0===a?"click":a,s=e.errorMessage,c=void 0===s?"":s,o=n?"enable":"disable",u="failed"===r?"".concat(r," - ").concat(c):r;t.a.pushObject({event:"clickAccount",eventAction:"click on button biometric",eventCategory:"biometrics setting page",eventLabel:"".concat(o," - ").concat(u),businessUnit:"user platform",currentSite:"tokopediamarketplace"})},r=function(e){var i=e.event,n=void 0===i?"success":i,a=e.errorMessage,r={success:"success",failed:"failed - ".concat(void 0===a?"":a),successBE:"success - backend",failedBE:"failed - error message"};t.a.pushObject({event:"clickAccount",eventAction:"click on masuk dengan biometric",eventCategory:"input biometric page",eventLabel:r[n],businessUnit:"user platform",currentSite:"tokopediamarketplace"})},s=function(){t.a.pushObject({event:"clickAccount",eventAction:"click on button close widget biometric",eventCategory:"input biometric page",eventLabel:"",businessUnit:"user platform",currentSite:"tokopediamarketplace"})},c=function(e){var i=e.event,n=void 0===i?"click":i,a=e.errorMessage,r=void 0===a?"":a,s="failed"===n?"".concat(n," - ").concat(r):n;t.a.pushObject({event:"clickAccount",eventAction:"click on masuk dengan biometric",eventCategory:"login page",eventLabel:s,businessUnit:"user platform",currentSite:"tokopediamarketplace"})},o=function(){t.a.pushObject({event:"clickAccount",eventAction:"click on button oke",eventCategory:"biometrics setting page",eventLabel:"",businessUnit:"user platform",currentSite:"tokopediamarketplace"})}},1686:function(e,i,n){"use strict";n.d(i,"g",(function(){return t})),n.d(i,"c",(function(){return a})),n.d(i,"a",(function(){return r})),n.d(i,"b",(function(){return s})),n.d(i,"h",(function(){return c})),n.d(i,"f",(function(){return o})),n.d(i,"e",(function(){return u})),n.d(i,"d",(function(){return l}));var t={en:"Verifikasi Instan",id:"Verifikasi Instan"},a={en:"Masuk dengan Verifikasi instan",id:"Masuk dengan Verifikasi instan"},r={en:"Sidik jari atau fitur lainnya di perangkatmu",id:"Sidik jari atau fitur lainnya di perangkatmu"},s={en:"Fitur ini harus diaktifkan lagi kalau dimatikan atau kamu atur ulang kata sandi",id:"Fitur ini harus diaktifkan lagi kalau dimatikan atau kamu atur ulang kata sandi"},c={en:"Sorry Your request could not be processed. Please try again.",id:"Maaf, permintaan Anda tidak dapat diproses. Silakan coba beberapa saat lagi."},o={en:"Hore! Kamu bisa masuk ke akunmu pakai Verifikasi Instan.",id:"Hore! Kamu bisa masuk ke akunmu pakai Verifikasi Instan."},u={en:"Tidak dapat menggunakan Verifikasi Instan",id:"Tidak dapat menggunakan Verifikasi Instan"},l={en:"Perangkatmu tidak mendukung untuk Verifikasi Instan, pastikan perangkatmu menyediakan Biometrics (Fingerprint,\n    Face ID, dll)",id:"Perangkatmu tidak mendukung untuk Verifikasi Instan, pastikan perangkatmu menyediakan Biometrics (Fingerprint,\n      Face ID, dll)"}},1897:function(e,i,n){"use strict";n.d(i,"a",(function(){return t}));var t="The operation either timed out or was not allowed"},2150:function(e,i,n){"use strict";var t=n(15),a=n(25),r=n(31),s=n(14),c=n.n(s),o=n(0),u=n(22),l=n(329),d=n.n(l),k=n(2151),m=n.n(k),f=n(1897),v=n(1535),g=n(1686);i.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id",i=Object(o.useRef)(0),n=Object(o.useState)({isSuccess:!1,errorMessage:"",pubKey:null}),s=Object(r.a)(n,2),l=s[0],k=s[1],p=l.isSuccess,b=l.errorMessage,h=l.pubKey,S=Object(u.useApolloClient)(),y=Object(o.useCallback)(Object(a.a)(c.a.mark((function n(){var a,r,s,o,u,l,p,b,h,O;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,S.query({query:m.a,fetchPolicy:"network-only"}).catch((function(i){i instanceof Error&&(i.message.includes(f.a)&&Object(v.a)(),k({isSuccess:!1,errorMessage:g.h[e],pubKey:null}),console.error("WEBAUTHN_REGISTER Network Err Begin Register - ".concat(i.message)),Object(v.d)({event:"failedBE",errorMessage:i.message}),Object(v.e)({isEnable:!0,errorMessage:i.message,event:"failed"}))}));case 2:if(a=n.sent){n.next=5;break}return n.abrupt("return");case 5:if(r=a.data||{},s=r.OTPBiometricBeginRegister||{},o=s.isSuccess||!1,u=s.errorMessage||"",o||!(i.current<2)){n.next=13;break}return y(),i.current+=1,n.abrupt("return");case 13:o||(console.error("WEBAUTHN_REGISTER BE Begin Register - ".concat(u)),k({isSuccess:o,errorMessage:u,pubKey:null})),l=s.publicKey,p=d()(l.challenge),b=d()(l.user.id),(h=JSON.parse(JSON.stringify(l))).user.id=b,h.challenge=p,h.authenticatorSelection.authenticatorAttachment||delete h.authenticatorSelection.authenticatorAttachment,h.authenticatorSelection.userVerification||(h.authenticatorSelection.userVerification="discouraged"),O=Object(t.a)({attestation:"none"},h),k({isSuccess:o,errorMessage:u,pubKey:O});case 24:case"end":return n.stop()}}),n)}))),[S,e]);return Object(o.useEffect)((function(){y()}),[y]),{isSuccess:p,errorMessage:b,pubKey:h}}},2151:function(e,i){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"biometricBeginRegister"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"OTPBiometricBeginRegister"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isSuccess"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"errorMessage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"publicKey"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"challenge"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"rp"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"icon"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"icon"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"pubKeyCredParams"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"alg"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"authenticatorSelection"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticatorAttachment"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"requireResidentKey"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userVerification"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"timeout"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:263}};n.loc.source={body:"query biometricBeginRegister{OTPBiometricBeginRegister{isSuccess errorMessage publicKey{challenge rp{name icon id}user{name icon displayName id}pubKeyCredParams{type alg}authenticatorSelection{authenticatorAttachment requireResidentKey userVerification}timeout}}}",name:"GraphQL request",locationOffset:{line:1,column:1}};function t(e,i){if("FragmentSpread"===e.kind)i.add(e.name.value);else if("VariableDefinition"===e.kind){var n=e.type;"NamedType"===n.kind&&i.add(n.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){t(e,i)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){t(e,i)})),e.definitions&&e.definitions.forEach((function(e){t(e,i)}))}var a={};function r(e,i){for(var n=0;n<e.definitions.length;n++){var t=e.definitions[n];if(t.name&&t.name.value==i)return t}}n.definitions.forEach((function(e){if(e.name){var i=new Set;t(e,i),a[e.name.value]=i}})),e.exports=n,e.exports.biometricBeginRegister=function(e,i){var n={kind:e.kind,definitions:[r(e,i)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var t=a[i]||new Set,s=new Set,c=new Set;for(t.forEach((function(e){c.add(e)}));c.size>0;){var o=c;c=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(a[e]||new Set).forEach((function(e){c.add(e)})))}))}return s.forEach((function(i){var t=r(e,i);t&&n.definitions.push(t)})),n}(n,"biometricBeginRegister")},2152:function(e,i,n){"use strict";var t=n(25),a=n(31),r=n(14),s=n.n(r),c=n(0),o=n(22),u=n(328),l=n.n(u),d=n(2153),k=n.n(d),m=n(1535);i.a=function(){var e=Object(c.useState)({}),i=Object(a.a)(e,2),n=i[0],r=i[1],u=function(e){return l()(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},d=Object(o.useApolloClient)(),f=function(){var e=Object(t.a)(s.a.mark((function e(i){var n,t,a,c,o,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.credentials.create({publicKey:i}).catch((function(e){throw e instanceof Error&&(console.error("WEBAUTHN_REGISTER Error Create Credential - ".concat(e.message)),Object(m.d)({event:"failed",errorMessage:JSON.stringify(e)}),Object(m.e)({isEnable:!0,errorMessage:JSON.stringify(e),event:"failed"})),e}));case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return");case 5:Object(m.d)({event:"success"}),t=n.type,a=n.id,c=u(n.rawId),o=u(n.response.attestationObject),l=u(n.response.clientDataJSON),r({id:a,rawId:c,response:{attestationObject:o,clientDataJSON:l},type:t});case 11:case"end":return e.stop()}}),e)})));return function(i){return e.apply(this,arguments)}}(),v=function(){var e=Object(t.a)(s.a.mark((function e(i){var t,a,r,c,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.query({query:k.a,variables:{input:n,validateToken:i}}).catch((function(e){throw e instanceof Error&&(console.error("WEBAUTHN_REGISTER Network Error Finish Register - ".concat(e.message)),Object(m.d)({event:"failedBE",errorMessage:e.message}),Object(m.e)({isEnable:!0,errorMessage:e.message,event:"failed"})),e}));case 2:if(t=e.sent,a=t.data||{},r=a.OTPBiometricFinishRegister||{},c=r.isSuccess||!1,o=r.errorMessage||"",c){e.next=11;break}return console.error("WEBAUTHN_REGISTER BE Finish Register - ".concat(o)),Object(m.d)({event:"failedBE",errorMessage:o}),e.abrupt("return",{isSuccessFinishRegister:c,errorMessage:o});case 11:return Object(m.e)({isEnable:!0,errorMessage:"",event:"success"}),e.abrupt("return",{isSuccessFinishRegister:c,errorMessage:o});case 13:case"end":return e.stop()}}),e)})));return function(i){return e.apply(this,arguments)}}();return{finishRegisterWebauthn:v,finishCreateKeyPair:f}}},2153:function(e,i){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"biometricFinishRegister"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FinishRegisterRequest"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"validateToken"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"OTPBiometricFinishRegister"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}},{kind:"Argument",name:{kind:"Name",value:"validateToken"},value:{kind:"Variable",name:{kind:"Name",value:"validateToken"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isSuccess"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"errorMessage"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:178}};n.loc.source={body:"query biometricFinishRegister($input:FinishRegisterRequest!,$validateToken:String!){OTPBiometricFinishRegister(input:$input,validateToken:$validateToken){isSuccess errorMessage}}",name:"GraphQL request",locationOffset:{line:1,column:1}};function t(e,i){if("FragmentSpread"===e.kind)i.add(e.name.value);else if("VariableDefinition"===e.kind){var n=e.type;"NamedType"===n.kind&&i.add(n.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){t(e,i)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){t(e,i)})),e.definitions&&e.definitions.forEach((function(e){t(e,i)}))}var a={};function r(e,i){for(var n=0;n<e.definitions.length;n++){var t=e.definitions[n];if(t.name&&t.name.value==i)return t}}n.definitions.forEach((function(e){if(e.name){var i=new Set;t(e,i),a[e.name.value]=i}})),e.exports=n,e.exports.biometricFinishRegister=function(e,i){var n={kind:e.kind,definitions:[r(e,i)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var t=a[i]||new Set,s=new Set,c=new Set;for(t.forEach((function(e){c.add(e)}));c.size>0;){var o=c;c=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(a[e]||new Set).forEach((function(e){c.add(e)})))}))}return s.forEach((function(i){var t=r(e,i);t&&n.definitions.push(t)})),n}(n,"biometricFinishRegister")},771:function(e,i,n){"use strict";n.r(i);var t=n(0),a=n.n(t),r=n(170),s=n(48),c=n(38),o=n(19),u=n(2150),l=n(2152),d=n(1181),k=n(56),m=n(66),f=n(8),v=n(59),g={id:{signOut:"Keluar Akun",canActivateInstantVerification:"Kamu bisa aktifkan Verifikasi Instan dulu, lho~",instantVerificationExplanation:"Nanti kamu bisa verifikasi dan masuk ke akunmu pakai sidik jari atau fitur serupa lainnya. Makin gampang dan praktis, deh!",activateNow:"Aktifkan Sekarang",continueSignOut:"Lanjut Keluar Akun",instantVerificationActivated:"Verifikasi Instan udah aktif",canUseInstantVerification:"Hore! Sekarang kamu bisa verifikasi dan masuk ke akunmu pakai fitur ini.",issueOnActivation:"Ada kendala waktu aktifkan fitur ini, coba lagi nanti ya."},en:{signOut:"Log Out",canActivateInstantVerification:"Kamu bisa aktifkan Verifikasi Instan dulu, lho~",instantVerificationExplanation:"Nanti kamu bisa verifikasi dan masuk ke akunmu pakai sidik jari atau fitur serupa lainnya. Makin gampang dan praktis, deh!",activateNow:"Aktifkan Sekarang",continueSignOut:"Lanjut Keluar Akun",instantVerificationActivated:"Verifikasi Instan udah aktif",canUseInstantVerification:"Hore! Sekarang kamu bisa verifikasi dan masuk ke akunmu pakai fitur ini.",issueOnActivation:"Ada kendala waktu aktifkan fitur ini, coba lagi nanti ya."}},p=n(1),b=n(2);const h=Object(b.css)("text-align:center;.image{width:280px;object-fit:contain;}.button-activate{margin:24px 0 8px;}.button-logout-account{margin:24px 0 8px;}"),S=Object(b.css)("color:",p.NN900,";"),y={event:"clickBiometrics",eventCategory:"logout page",businessUnit:"user platform",currentSite:"tokopediamarketplace",eventLabel:""},O=e=>{const[i,n]=Object(t.useState)(!1),[v,p]=Object(t.useState)(!1),{show:b,onClose:O,onLogout:N}=e,{lang:E}=Object(t.useContext)(k.a),{showToaster:A,hideToaster:j}=Object(m.c)(),{errorMessage:F,pubKey:w}=Object(u.a)(),{finishRegisterWebauthn:R,finishCreateKeyPair:T}=Object(l.a)(),V=Object(t.useCallback)(((e={})=>{const{error:i=!1,text:n,delay:t=5e3,onActionClick:a=j,actionText:r=""}=e;A(n,r,a,i,t)}),[j,A]);Object(t.useEffect)((()=>{F&&V({error:!0,text:F})}),[V,F]);const M=()=>{f.default.pushObject({event:"clickLogin",eventCategory:"one click login ",eventAction:"click on button nanti login account",eventLabel:""}),f.default.pushObject({...y,eventAction:"biometrics - click on tetap keluar",eventLabel:"click"}),N&&N()},x=async()=>{f.default.pushObject({...y,eventAction:"biometrics - click on aktivasi",eventLabel:"click"});try{await T(w)}catch(e){return f.default.pushObject({...y,eventAction:"biometrics - click on aktivasi",eventLabel:`failed - ${e.message}`}),void V({text:g[E].issueOnActivation,error:!0})}n(!0)},B=async({validateToken:e,errMsg:i},t)=>{if(i)return f.default.pushObject({...y,eventAction:"biometrics - click on aktivasi",eventLabel:`failed - ${i}`}),V({text:i,error:!0}),void t();const a=await R(e).catch((e=>{f.default.pushObject({...y,eventAction:"biometrics - click on aktivasi",eventLabel:`failed - ${e.message}`}),V({text:g[E].issueOnActivation,error:!0})}));if(!a)return;const{isSuccessFinishRegister:r,errorMessage:s}=a;if(n(!1),!r)return f.default.pushObject({...y,eventAction:"biometrics - click on aktivasi",eventLabel:`failed - ${s}`}),void V({text:s,error:!0});f.default.pushObject({...y,eventAction:"biometrics - click on aktivasi",eventLabel:"success"}),p(!0)};return a.a.createElement(r.a,{display:b,onClose:()=>{n(!1),O&&O()},minWidth:"420px",zIndex:1e3},i?a.a.createElement(d.default,{afterValidate:B,displayToaster:V,input:"",otpType:o.K,lang:E}):v?a.a.createElement(a.a.Fragment,null,a.a.createElement("img",{className:"image",src:"https://images.tokopedia.net/img/instant-verification/offering/success/Illustration.png",alt:"offering instant verification"}),a.a.createElement(c.default,{className:S,tag:2},g[E].instantVerificationActivated),a.a.createElement(c.default,{body:"paragraph-2"},g[E].canUseInstantVerification),a.a.createElement(s.default,{"data-testid":"logout-button-final",className:"button-logout-account",filled:!0,main:!0,block:!0,onClick:M},g[E].signOut)):a.a.createElement("div",{className:h},a.a.createElement("img",{className:"image",src:"https://images.tokopedia.net/img/instant-verification/offering/Illustration.png",alt:"offering instant verification"}),a.a.createElement(c.default,{className:S,tag:3},g[E].canActivateInstantVerification),a.a.createElement(c.default,{body:"paragraph-2"},g[E].instantVerificationExplanation),a.a.createElement(s.default,{className:"button-activate",filled:!0,main:!0,block:!0,large:!0,onClick:x},g[E].activateNow),a.a.createElement(s.default,{ghost:!0,main:!0,block:!0,large:!0,onClick:M},g[E].continueSignOut)))};O.defaultProps={show:!1,onClose:v.a,onLogout:v.a};i.default=O}}]);